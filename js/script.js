
var data = [
		{
			'title' : '<span style="font-weight: bold">Vase of Flowers, 1722. Jan van Huysum (Dutch, 1682–1749)</span><br><span>Oil on panel, 99.1 x 81 (39 x 31 7/8 in.)</span><br><span>On view in gallery E203</span>',
			'description' : 'Jan van Huysum’s exquisite bouquets of flowers from different seasons were prized for their loose, asymmetrical arrangements that reflect the period’s emerging taste for freer, graceful forms.',
			'imgUrl' : 'img/painting_1.jpg',
			'height' : '452.5px',
			'frames' : [
				{
					'title' : 'OPTION I',
					'textMatch_header' : 'A perfect match!',
					'textMatch_body': 'This gilded Régence frame currently surrounds Van Huysum’s Vase of Flowers. Its sculpted corners and curling tendrils complement the painting’s exuberance and would have been favored by eighteenth-century French and Dutch collectors.',
					'frame_corner_imgUrl' : 'img/painting_1_frame_1_corner.png',
					'frame_imgUrl' : 'img/painting_1_frame_1.png',
					'margin_top' : '88px',
					'margin_left' : '32px',
					'height' : '598px'
				}, {
					'title' : 'OPTION II',
					'textMatch_header' : 'A very Dutch choice!',
					'textMatch_body' : 'This 17th century Dutch frame in expensive polished fruitwood provides a plainer, darker border to the sumptuous bouquet. Preferred by some Getty curators for its simplicity, it has been used periodically to frame Van Huysum’s still life.',
					'frame_corner_imgUrl' : 'img/painting_1_frame_2_corner.png',
					'frame_imgUrl' : 'img/painting_1_frame_2.png',
					'margin_top' : '101px',
					'margin_left' : 'auto',
					'height' : '579.5px'
				}, {
					'title' : 'OPTION III',
					'textMatch_header' : 'Oh dear, too severe!',
					'textMatch_body' : 'The elegant simplicity of this Louis XVI scotia frame by Chérin provides a less sympathetic surrounding for the Vase of Flowers. The frame’s linearity constrains and detracts from the dynamism of Van Huysum’s botanical forms.',
					'frame_corner_imgUrl' : 'img/painting_1_frame_3_corner.png',
					'frame_imgUrl' : 'img/painting_1_frame_3.png',
					'margin_top' : '102px',
					'margin_left' : 'auto',
					'height' : '576px'
				}
			]
		}, {
			'title' : '<span style="font-weight: bold">Mars and Venus, Allegory of Peace, 1770. Louis-Jean François Lagrenée (French, 1725–1805)</span><br><span>Oil on canvas, 85.1 x 74.3 cm (33 1/2 x 29 1/4 in.)</span><br><span>On view in the exhibition</span>',
			'description' : 'Lagrenée’s polished style and contrasts of rich color create a quiet and sensual portrayal of the god of war observing his sleeping lover, the goddess Venus. ',
			'imgUrl' : 'img/painting_2.jpg',
			'height' : '443px',
			'frames' : [
				{
					'title' : 'OPTION I',
					'textMatch_header' : 'Oof! Overpowering!',
					'textMatch_body' : 'As a leading exponent of restrained classicism, Lagrenée would have strongly opposed this showy Louis XV frame. Its curving edges compete with the contained composition of the central image. ',
					'frame_corner_imgUrl' : 'img/painting_2_frame_1_corner.png',
					'frame_imgUrl' : 'img/painting_2_frame_1.png',
					'margin_top' : '84px',
					'margin_left' : 'auto',
					'height' : '613px'
				}, {
					'title' : 'OPTION II',
					'textMatch_header' : 'Over-the-top revival',
					'textMatch_body' : 'The painting arrived at the Getty in this gaudy Louis XVI revival frame that broadcasts the artist’s name at the top. Its heavy forms and brassy color clash with the subtlety of Lagrenée’s painting.',
					'frame_corner_imgUrl' : 'img/painting_2_frame_2_corner.png',
					'frame_imgUrl' : 'img/painting_2_frame_2.png',
					'margin_top' : '45px',
					'margin_left' : 'auto',
					'height' : '644.5px'
				}, {
					'title' : 'OPTION III',
					'textMatch_header' : 'Complementary classicism',
					'textMatch_body' : 'You’ve selected the current Louis XVI frame, which is contemporary with the painting. The repeated pattern of the egg-and-dart motif provides a regularity that reinforces the calm mood of the scene.',
					'frame_corner_imgUrl' : 'img/painting_2_frame_3_corner.png',
					'frame_imgUrl' : 'img/painting_2_frame_3.png',
					'margin_top' : '85px',
					'margin_left' : 'auto',
					'height' : '612px'
				}
			]
		}, {
			'title' : '<span style="font-weight: bold">Spring (Jeanne Demarsy), 1881. Édouard Manet (French, 1832–1883)</span><br><span>Oil on canvas, 98.7 x 75.9 cm (38 7/8 x 29 7/8 in.)</span><br><span>On view in Gallery W204</span>',
			'description' : 'Manet portrayed the young actress Jean Demarsy in a floral-patterned gown against a leafy backdrop as an allegory of Spring. His forthright technique and colorful palette give the painting immediacy and freshness.',
			'imgUrl' : 'img/painting_3.jpg',
			'height' : '450.5px',
			'frames' : [
				{
					'title' : 'OPTION I',
					'textMatch_header' : 'Perfectly suited to the Salon',
					'textMatch_body' : 'You’ve selected a French 19th century gilded "Salon" frame, named for the annual Paris exhibition where Spring was first shown in 1882. The plain sight edge creates a window onto the composition, while the ornamentation resonates with Manet’s lively brushwork. ',					
					'frame_corner_imgUrl' : 'img/painting_3_frame_1_corner.png',
					'frame_imgUrl' : 'img/painting_3_frame_1.png',
					'margin_top' : '74px',
					'margin_left' : 'auto',
					'height' : '629px'
				}, {
					'title' : 'OPTION II',
					'textMatch_header' : 'Showstopper',
					'textMatch_body' : 'Spring was in this Louis XV frame for many years—perhaps over a century. The boisterous curves and exuberant ornamentation call attention to the painting but also compete with its varied brushwork and bold color.',
					'frame_corner_imgUrl' : 'img/painting_3_frame_2_corner.png',
					'frame_imgUrl' : 'img/painting_3_frame_2.png',
					'margin_top' : '44px',
					'margin_left' : 'auto',
					'height' : '683px'
				}, {
					'title' : 'OPTION III',
					'textMatch_header' : 'Botanical overload',
					'textMatch_body' : 'The richly carved botanical motifs of the Louis XIII frame may seem to further embellish the painting, but the heavy Baroque forms of this garland are at odds with Manet’s bright palette and light, energetic brushwork.',
					'frame_corner_imgUrl' : 'img/painting_3_frame_3_corner.png',
					'frame_imgUrl' : 'img/painting_3_frame_3.png',
					'margin_top' : '91px',
					'margin_left' : 'auto',
					'height' : '586.5px'
				}
			]
		}, {
			'title' : '<span style="font-weight: bold">Suzanne Le Peletier de Saint–Fargeau, 1804. Jacques-Louis David (French, 1748–1825)</span><br><span>Oil on canvas, 83.2 x 73 cm (32 3/4 x 28 3/4 in.)</span><br><span>On view in Gallery S204</span>',
			'description' : 'Both the sitter and the painter were strong supporters of Emperor Napoleon. David’s informal yet direct presentation of the sitter created a strikingly intimate portrait intended for her fiancée. ',
			'imgUrl' : 'img/painting_4.jpg',
			'height' : '435px',
			'frames' : [
				{
					'title' : 'OPTION I',
					'textMatch_header' : 'Harmonious ensemble',
					'textMatch_body' : 'You’ve chosen the current frame in the Empire style, carved and gilded in France during the early 19th century. The elegant scrolling-leaf band and palmette corners were common during the Napoleonic Empire and fit the status of both painter and sitter.',
					'frame_corner_imgUrl' : 'img/painting_4_frame_1_corner.png',
					'frame_imgUrl' : 'img/painting_4_frame_1.png',
					'margin_top' : '45px',
					'margin_left' : '-31px',
					'height' : '690px'
				}, {
					'title' : 'OPTION II',
					'textMatch_header' : 'Hmmm. It’s … a frame.',
					'textMatch_body' : 'This plain Neoclassical frame postdates the painting by several decades. The choice of a previous owner, its simple, austere style contrasts with David’s descriptive brushwork and restrains the relaxed immediacy of the portrait.',					
					'frame_corner_imgUrl' : 'img/painting_4_frame_2_corner.png',
					'frame_imgUrl' : 'img/painting_4_frame_2.png',
					'margin_top' : '85px',
					'margin_left' : 'auto',
					'height' : '607px'
				}, {
					'title' : 'OPTION III',
					'textMatch_header' : 'Too, too ...',
					'textMatch_body' : 'You’ve selected a Louis XVI frame suitable for a portrait; however, the ribbon and flower ornaments are too ornate and crowd the head of David’s robust sitter.',					
					'frame_corner_imgUrl' : 'img/painting_4_frame_3_corner.png',
					'frame_imgUrl' : 'img/painting_4_frame_3.png',
					'margin_top' : '1px',
					'margin_left' : 'auto',
					'height' : '689px'
				}
			]
		}
	];

$('#start-btn').on('touchstart click', function() {
	
	// remove start screen
	$('.start-screen').fadeOut();

	var leftMenuClicked,
		rightMenuIsOpen = false,
		rightMenuOpenAuto = false,
		app_runtime_counter = 0;

	var leftMenuOpen = function() {
		$('#painting-menu').addClass('open');
		$('#showroom').addClass('goRight');
		$('.painting_position img').attr('src', 'img/placeholder_painting.png').css({'box-shadow':'none', opacity: '0.75'});
		
		$('#frame-menu').removeClass('open');
		$('#showroom').removeClass('goLeft');
		$('.frame_position img').attr('src', 'img/placeholder_frame.png');
		
		$('#description').removeClass('show');
		$('#textMatch').removeClass('show');
		$('#credit-btn').addClass('show');
	}

	var leftMenuClose = function() {
		$('#painting-menu').removeClass('open');
		$('#showroom').removeClass('goRight');
	}

	var rightMenuOpen = function() {
		var painting_selected = $('.painting_position img').attr('src');
		if ( painting_selected.indexOf(".jpg") > -1 ) {
			$('#frame-menu').addClass('open');
			$('#showroom').addClass('goLeft');
			$('.frame_position img').attr('src', 'img/placeholder_frame.png');
			$('#textMatch').removeClass('show');
			app_runtime_counter += 1;
			rightMenuIsOpen = true;
			console.log(rightMenuIsOpen);
			console.log(app_runtime_counter);
			return rightMenuIsOpen;
		} else {
			e.preventDefault();
		}
	}

	var rightMenuClose = function() {
		$('#frame-menu').removeClass('open');
		$('#showroom').removeClass('goLeft');
		rightMenuIsOpen = false;
		return rightMenuIsOpen;
	}

	var credits = function() {
		var credits = [];
		for (var i = 0; i < data.length; i++ ) {
			credits += "<div class='credit'><img src='" + data[i].imgUrl +  "' />" + "<p>" + data[i].title +"</p></div>";
		}
		$('#credit .text').html(credits);
	}

	$('#leftMenu').on('touchstart click', function() {
		clearTimeout(leftMenuClicked);
		leftMenuOpen();
	})

	$('#rightMenu').on('touchstart click', function(e) {
		if ( rightMenuIsOpen ) {
			e.preventDefault();
		} else {
			rightMenuOpen();
		}
	})

	$('#credit-btn').on('touchstart click', function() {
		credits();
		$('#credit').show();
	})

	$('#credit .close').on('touchstart click', function() {
		$('#credit').hide();
	})

	// open the left menu first time app runs
	leftMenuOpen();
	$('#guide_paintings').fadeIn();


	( function() {
		var container = document.getElementById ( 'container' ),
			paintingSelection = document.getElementById( 'painting-menu' ),
			frameSelection = document.getElementById( 'frame-menu' ),
			droppablePainting = [],
			droppableFrame = [],
			draggablesPainting = [],
			draggablesFrame = [];

		// initialize droppable for paintings
		var droppableEl = document.querySelector( '#showroom .wall .painting_position' );
		droppablePainting =  new Droppable( droppableEl , {});

		// initialize draggable paintings
		Array.prototype.slice.call(document.querySelectorAll( '#painting-menu .painting' )).forEach( function( draggableEl ) {
			draggablesPainting.push(
				new Draggable( draggableEl, droppablePainting, {
					// draggable area
					draggabilly : { containment: container },
					onStart : function() {
						// to disable other draggables 
						draggablesPainting.forEach( function( el2 ) {
							el2.draggie.isEnabled = false;
						});
						$('#guide_paintings').fadeOut();
					},
					onEnd : function( wasDropped ) {
						var afterDropFn = function() {
							// hide showroom
							if (!wasDropped) {
								//
							} else {
								// close the left menu
								leftMenuClose();

								// display dropped painting
								var src = draggableEl.getAttribute("src"),
									index = draggableEl.getAttribute('data-index'),
									height = data[index].height,
									selectedImage = draggableEl;

								$('.painting_position img').attr("src", src).css({ height: height, opacity: '1', 'box-shadow': '0px 4px 4px #444'});
								
								// display painting description
								var description = data[index].description;

								$('#credit-btn').removeClass('show');
								$('#description').html(description).addClass('show');

								
								// open the right menu after 2s
								leftMenuClicked = setTimeout(function() {
									rightMenuOpen();
									rightMenuOpenAuto = true;
									if (rightMenuIsOpen && rightMenuOpenAuto && app_runtime_counter === 1) {
										$('#guide_frames').fadeIn();
									}
								}, 2000);

								// load selected painting's frames
								var frame_data = data[index].frames;

								var loadFrames = function(src, index) {
									var frame = "";
									for (var i = 0; i < frame_data.length; i++ ) {
										frame += '<div class="frame_info"><div class="frame_title">' + frame_data[i].title + '</div></div><div class="frame"><img src="' + frame_data[i].frame_corner_imgUrl + '" data-index="' + i + '" class="frame" /></div>';
									};
									// display frames
									$('#frames').html(frame);

									// initialize droppableFrame
									var droppableEl = document.querySelector( '#showroom .wall .frame_position' );
									droppableFrame =  new Droppable( droppableEl , {});

									// initialize draggable frames
									[].slice.call(document.querySelectorAll( '#frames .frame' )).forEach( function( draggableEl ) {
										draggablesFrame.push(
											new Draggable( draggableEl, droppableFrame, {
												draggabilly : { containment: container },
												onStart : function() {
													// to disable other draggables
													draggablesFrame.forEach( function( el2 ) {
														el2.draggie.isEnabled = false;
													});
													$('#guide_frames').fadeOut();
												},
												onDrag : function() {
													droppableFrame.highlight(draggableEl, index);
												},
												onEnd : function( wasDropped ) {
													var afterDropFn = function() {
														// hide dropArea
														if (!wasDropped) {
															//
														} else {
															// closes the right menu
															rightMenuClose();

															// display dropped frame
															var index = draggableEl.getAttribute('data-index'),
																src = frame_data[index].frame_imgUrl,
																margin_top = frame_data[index].margin_top,
																margin_left = frame_data[index].margin_left,
																height = frame_data[index].height;

															$('.frame_position img').attr("src", src).css({ height: height, marginTop: margin_top, marginLeft: margin_left, opacity: '1'});
															
															// display the selection text
															var textMatch_header = '<h2>' + frame_data[index].textMatch_header + '</h2>',
																textMatch_body = frame_data[index].textMatch_body;
															
															$('#textMatch').html( textMatch_header + textMatch_body ).addClass('show');
														}
														// to enable all draggables (for frames) again
														draggablesFrame.forEach( function( el2 ) {
															el2.draggie.isEnabled = true;
														});
													}
													afterDropFn(); // afterDropFn for frames
												} // on End for frames
											})
										)
									});
								};
								loadFrames(src, index); // load frames
							}
						}
					afterDropFn(); // afterDropFn for paintings
					// to enable all draggables (for paintings) again
					draggablesPainting.forEach( function( el2 ) {
						el2.draggie.isEnabled = true;
					});
					} // on End for paintings
				})
			)
		}); // Draggable for paintings
	})();
})